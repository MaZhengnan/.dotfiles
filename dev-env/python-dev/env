#!/usr/bin/env bash
set -e

ACTION="$1"
CONTAINER="$2"

# å¦‚æœæ²¡ä¼ å®¹å™¨åï¼Œå°è¯•ä» podman-compose.yml æ¨æ–­
if [[ -z "$CONTAINER" ]]; then
  CONTAINER=$(podman ps -a --format "{{.Names}}" | head -n1)
fi

if [[ -z "$CONTAINER" ]]; then
  echo "âŒ No container name provided or detected"
  exit 1
fi

case "$ACTION" in
  build)
    echo "ğŸ”¨ Building container..."
    podman-compose build
    ;;
  up)
    echo "ğŸš€ Starting container..."
    podman-compose up -d
    ;;
  down)
    echo "ğŸ›‘ Stopping container..."
    podman-compose down
    ;;
  rebuild)
    echo "â™»ï¸ Rebuilding container..."
    podman-compose down
    podman-compose build
    podman-compose up -d
    ;;
  enter|shell)
    echo "ğŸš Entering container: $CONTAINER"
    podman exec -it "$CONTAINER" bash
    ;;
  logs)
    podman logs "$CONTAINER"
    ;;
  *)
    echo "Usage:"
    echo "  $0 build [container]"
    echo "  $0 up [container]"
    echo "  $0 down [container]"
    echo "  $0 rebuild [container]"
    echo "  $0 enter [container]"
    echo "  $0 logs [container]"
    exit 1
    ;;
esac
